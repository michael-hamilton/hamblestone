{"version":3,"sources":["projects/smb/lib/impact/impact.js"],"names":["window","Number","prototype","map","istart","istop","ostart","ostop","limit","min","max","Math","round","precision","pow","floor","ceil","toInt","toRad","PI","toDeg","Array","erase","item","i","length","splice","random","Function","bind","oThis","TypeError","aArgs","slice","call","arguments","fToBind","fNOP","fBound","apply","concat","ig","game","debug","version","global","modules","resources","ready","baked","nocache","ua","prefix","ImpactPrefix","lib","_current","_loadQueue","_waitForOnload","$","selector","charAt","document","getElementById","substr","getElementsByTagName","$new","name","createElement","copy","object","HTMLElement","Class","c","l","merge","original","extended","key","ext","ksort","obj","keys","values","push","sort","setVendorAttribute","el","attr","val","uc","toUpperCase","getVendorAttribute","normalizeVendorAttribute","prefixedVal","getImagePixels","image","x","y","width","height","canvas","ctx","getContext","System","SCALE","CRISP","ratio","realWidth","realHeight","drawImage","getImageData","getImageDataHD","module","body","requires","loaded","defines","_initDOMReady","addResource","resource","setNocache","set","Date","now","log","assert","condition","msg","show","number","mark","color","_loadScript","requiredFrom","path","replace","script","type","src","onload","_execModules","onerror","appendChild","modulesLoaded","m","dependenciesLoaded","j","unresolved","unloaded","join","_DOMReady","setTimeout","_boot","location","href","match","pixelRatio","devicePixelRatio","viewport","innerWidth","innerHeight","screen","availWidth","availHeight","iPhone","test","navigator","userAgent","iPhone4","iPad","android","winPhone","iOS","mobile","touchDevice","msMaxTouchPoints","readyState","addEventListener","requestAnimationFrame","next","anims","setAnimation","callback","element","current","animate","clearAnimation","id","setInterval","clearInterval","initializing","fnTest","xyz","inject","prop","proto","parent","fn","tmp","ret","extend","staticInstantiate","p","init","constructor","ImpactMixin","main","canvasId","gameClass","fps","scale","loaderClass","system","input","Input","soundManager","SoundManager","music","Music","loader","Loader","load"],"mappings":"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","file":"impact.bd0e6a03.js","sourceRoot":"../pages","sourcesContent":["\n// -----------------------------------------------------------------------------\n// Impact Game Engine 1.22\n// http://impactjs.com/\n// -----------------------------------------------------------------------------\n\n\n(function(window){ \"use strict\";\n\n// -----------------------------------------------------------------------------\n// Native Object extensions\n\nNumber.prototype.map = function(istart, istop, ostart, ostop) {\n\treturn ostart + (ostop - ostart) * ((this - istart) / (istop - istart));\n};\n\nNumber.prototype.limit = function(min, max) {\n\treturn Math.min(max, Math.max(min, this));\n};\n\nNumber.prototype.round = function(precision) {\n\tprecision = Math.pow(10, precision || 0);\n\treturn Math.round(this * precision) / precision;\n};\n\nNumber.prototype.floor = function() {\n\treturn Math.floor(this);\n};\n\nNumber.prototype.ceil = function() {\n\treturn Math.ceil(this);\n};\n\nNumber.prototype.toInt = function() {\n\treturn (this | 0);\n};\n\nNumber.prototype.toRad = function() {\n\treturn (this / 180) * Math.PI;\n};\n\nNumber.prototype.toDeg = function() {\n\treturn (this * 180) / Math.PI;\n};\n\nArray.prototype.erase = function(item) {\n\tfor( var i = this.length; i--; ) {\n\t\tif( this[i] === item ) {\n\t\t\tthis.splice(i, 1);\n\t\t}\n\t}\n\treturn this;\n};\n\nArray.prototype.random = function() {\n\treturn this[ Math.floor(Math.random() * this.length) ];\n};\n\nFunction.prototype.bind = Function.prototype.bind || function (oThis) {\n\tif( typeof this !== \"function\" ) {\n\t\tthrow new TypeError(\"Function.prototype.bind - what is trying to be bound is not callable\");\n\t}\n\n\tvar aArgs = Array.prototype.slice.call(arguments, 1),\n\t\tfToBind = this,\n\t\tfNOP = function () {},\n\t\tfBound = function () {\n\t\t\treturn fToBind.apply(\n\t\t\t\t(this instanceof fNOP && oThis ? this : oThis),\n\t\t\t\taArgs.concat(Array.prototype.slice.call(arguments))\n\t\t\t);\n\t\t};\n\n\tfNOP.prototype = this.prototype;\n\tfBound.prototype = new fNOP();\n\n\treturn fBound;\n};\n\n\n// -----------------------------------------------------------------------------\n// ig Namespace\n\nwindow.ig = {\n\tgame: null,\n\tdebug: null,\n\tversion: '1.22',\n\tglobal: window,\n\tmodules: {},\n\tresources: [],\n\tready: false,\n\tbaked: false,\n\tnocache: '',\n\tua: {},\n\tprefix: (window.ImpactPrefix || ''),\n\tlib: 'lib/',\n\t\n\t_current: null,\n\t_loadQueue: [],\n\t_waitForOnload: 0,\n\t\n\t\n\t$: function( selector ) {\n\t\treturn selector.charAt(0) == '#'\n\t\t\t? document.getElementById( selector.substr(1) )\n\t\t\t: document.getElementsByTagName( selector );\n\t},\n\t\n\t\n\t$new: function( name ) {\n\t\treturn document.createElement( name );\n\t},\n\t\n\t\n\tcopy: function( object ) {\n\t\tif(\n\t\t   !object || typeof(object) != 'object' ||\n\t\t   object instanceof HTMLElement ||\n\t\t   object instanceof ig.Class\n\t\t) {\n\t\t\treturn object;\n\t\t}\n\t\telse if( object instanceof Array ) {\n\t\t\tvar c = [];\n\t\t\tfor( var i = 0, l = object.length; i < l; i++) {\n\t\t\t\tc[i] = ig.copy(object[i]);\n\t\t\t}\n\t\t\treturn c;\n\t\t}\n\t\telse {\n\t\t\tvar c = {};\n\t\t\tfor( var i in object ) {\n\t\t\t\tc[i] = ig.copy(object[i]);\n\t\t\t}\n\t\t\treturn c;\n\t\t}\n\t},\n\t\n\t\n\tmerge: function( original, extended ) {\n\t\tfor( var key in extended ) {\n\t\t\tvar ext = extended[key];\n\t\t\tif(\n\t\t\t\ttypeof(ext) != 'object' ||\n\t\t\t\text instanceof HTMLElement ||\n\t\t\t\text instanceof ig.Class\n\t\t\t) {\n\t\t\t\toriginal[key] = ext;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif( !original[key] || typeof(original[key]) != 'object' ) {\n\t\t\t\t\toriginal[key] = (ext instanceof Array) ? [] : {};\n\t\t\t\t}\n\t\t\t\tig.merge( original[key], ext );\n\t\t\t}\n\t\t}\n\t\treturn original;\n\t},\n\t\n\t\n\tksort: function( obj ) {\n\t\tif( !obj || typeof(obj) != 'object' ) {\n\t\t\treturn [];\n\t\t}\n\t\t\n\t\tvar keys = [], values = [];\n\t\tfor( var i in obj ) {\n\t\t\tkeys.push(i);\n\t\t}\n\t\t\n\t\tkeys.sort();\n\t\tfor( var i = 0; i < keys.length; i++ ) {\n\t\t\tvalues.push( obj[keys[i]] );\n\t\t}\n\t\t\n\t\treturn values;\n\t},\n\n\t// Ah, yes. I love vendor prefixes. So much fun!\n\tsetVendorAttribute: function( el, attr, val ) {\n\t\tvar uc = attr.charAt(0).toUpperCase() + attr.substr(1);\n\t\tel[attr] = el['ms'+uc] = el['moz'+uc] = el['webkit'+uc] = el['o'+uc] = val;\n\t},\n\n\n\tgetVendorAttribute: function( el, attr ) {\n\t\tvar uc = attr.charAt(0).toUpperCase() + attr.substr(1);\n\t\treturn el[attr] || el['ms'+uc] || el['moz'+uc] || el['webkit'+uc] || el['o'+uc];\n\t},\n\n\n\tnormalizeVendorAttribute: function( el, attr ) {\n\t\tvar prefixedVal = ig.getVendorAttribute( el, attr );\n\t\tif( !el[attr] && prefixedVal ) {\n\t\t\tel[attr] = prefixedVal;\n\t\t}\n\t},\n\n\n\t// This function normalizes getImageData to extract the real, actual\n\t// pixels from an image. The naive method recently failed on retina\n\t// devices with a backgingStoreRatio != 1\n\tgetImagePixels: function( image, x, y, width, height ) {\n\t\tvar canvas = ig.$new('canvas');\n\t\tcanvas.width = image.width;\n\t\tcanvas.height = image.height;\n\t\tvar ctx = canvas.getContext('2d');\n\t\t\n\t\t// Try to draw pixels as accurately as possible\n\t\tig.System.SCALE.CRISP(canvas, ctx);\n\n\t\tvar ratio = ig.getVendorAttribute( ctx, 'backingStorePixelRatio' ) || 1;\n\t\tig.normalizeVendorAttribute( ctx, 'getImageDataHD' );\n\n\t\tvar realWidth = image.width / ratio,\n\t\t\trealHeight = image.height / ratio;\n\n\t\tcanvas.width = Math.ceil( realWidth );\n\t\tcanvas.height = Math.ceil( realHeight );\n\n\t\tctx.drawImage( image, 0, 0, realWidth, realHeight );\n\t\t\n\t\treturn (ratio === 1)\n\t\t\t? ctx.getImageData( x, y, width, height )\n\t\t\t: ctx.getImageDataHD( x, y, width, height );\n\t},\n\n\t\n\tmodule: function( name ) {\n\t\tif( ig._current ) {\n\t\t\tthrow( \"Module '\"+ig._current.name+\"' defines nothing\" );\n\t\t}\n\t\tif( ig.modules[name] && ig.modules[name].body ) {\n\t\t\tthrow( \"Module '\"+name+\"' is already defined\" );\n\t\t}\n\t\t\n\t\tig._current = {name: name, requires: [], loaded: false, body: null};\n\t\tig.modules[name] = ig._current;\n\t\tig._loadQueue.push(ig._current);\n\t\treturn ig;\n\t},\n\t\n\t\n\trequires: function() {\n\t\tig._current.requires = Array.prototype.slice.call(arguments);\n\t\treturn ig;\n\t},\n\t\n\t\n\tdefines: function( body ) {\n\t\tig._current.body = body;\n\t\tig._current = null;\n\t\tig._initDOMReady();\n\t},\n\t\n\t\n\taddResource: function( resource ) {\n\t\tig.resources.push( resource );\n\t},\n\t\n\t\n\tsetNocache: function( set ) {\n\t\tig.nocache = set\n\t\t\t? '?' + Date.now()\n\t\t\t: '';\n\t},\n\t\n\t\n\t// Stubs for ig.Debug\n\tlog: function() {},\n\tassert: function( condition, msg ) {},\n\tshow: function( name, number ) {},\n\tmark: function( msg, color ) {},\n\t\n\t\n\t_loadScript: function( name, requiredFrom ) {\n\t\tig.modules[name] = {name: name, requires:[], loaded: false, body: null};\n\t\tig._waitForOnload++;\n\t\t\n\t\tvar path = ig.prefix + ig.lib + name.replace(/\\./g, '/') + '.js' + ig.nocache;\n\t\tvar script = ig.$new('script');\n\t\tscript.type = 'text/javascript';\n\t\tscript.src = path;\n\t\tscript.onload = function() {\n\t\t\tig._waitForOnload--;\n\t\t\tig._execModules();\n\t\t};\n\t\tscript.onerror = function() {\n\t\t\tthrow(\n\t\t\t\t'Failed to load module '+name+' at ' + path + ' ' +\n\t\t\t\t'required from ' + requiredFrom\n\t\t\t);\n\t\t};\n\t\tig.$('head')[0].appendChild(script);\n\t},\n\n\t\n\t_execModules: function() {\n\t\tvar modulesLoaded = false;\n\t\tfor( var i = 0; i < ig._loadQueue.length; i++ ) {\n\t\t\tvar m = ig._loadQueue[i];\n\t\t\tvar dependenciesLoaded = true;\n\t\t\t\n\t\t\tfor( var j = 0; j < m.requires.length; j++ ) {\n\t\t\t\tvar name = m.requires[j];\n\t\t\t\tif( !ig.modules[name] ) {\n\t\t\t\t\tdependenciesLoaded = false;\n\t\t\t\t\tig._loadScript( name, m.name );\n\t\t\t\t}\n\t\t\t\telse if( !ig.modules[name].loaded ) {\n\t\t\t\t\tdependenciesLoaded = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif( dependenciesLoaded && m.body ) {\n\t\t\t\tig._loadQueue.splice(i, 1);\n\t\t\t\tm.loaded = true;\n\t\t\t\tm.body();\n\t\t\t\tmodulesLoaded = true;\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif( modulesLoaded ) {\n\t\t\tig._execModules();\n\t\t}\n\t\t\n\t\t// No modules executed, no more files to load but loadQueue not empty?\n\t\t// Must be some unresolved dependencies!\n\t\telse if( !ig.baked && ig._waitForOnload == 0 && ig._loadQueue.length != 0 ) {\n\t\t\tvar unresolved = [];\n\t\t\tfor( var i = 0; i < ig._loadQueue.length; i++ ) {\n\t\t\t\t\n\t\t\t\t// Which dependencies aren't loaded?\n\t\t\t\tvar unloaded = [];\n\t\t\t\tvar requires = ig._loadQueue[i].requires;\n\t\t\t\tfor( var j = 0; j < requires.length; j++ ) {\n\t\t\t\t\tvar m = ig.modules[ requires[j] ];\n\t\t\t\t\tif( !m || !m.loaded ) {\n\t\t\t\t\t\tunloaded.push( requires[j] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tunresolved.push( ig._loadQueue[i].name + ' (requires: ' + unloaded.join(', ') + ')');\n\t\t\t}\n\t\t\t\n\t\t\tthrow( \n\t\t\t\t'Unresolved (circular?) dependencies. ' +\n\t\t\t\t\"Most likely there's a name/path mismatch for one of the listed modules:\\n\" +\t\t\t\n\t\t\t\tunresolved.join('\\n')\t\t\t\t\n\t\t\t);\n\t\t}\n\t},\n\t\n\t\n\t_DOMReady: function() {\n\t\tif( !ig.modules['dom.ready'].loaded ) {\n\t\t\tif ( !document.body ) {\n\t\t\t\treturn setTimeout( ig._DOMReady, 13 );\n\t\t\t}\n\t\t\tig.modules['dom.ready'].loaded = true;\n\t\t\tig._waitForOnload--;\n\t\t\tig._execModules();\n\t\t}\n\t\treturn 0;\n\t},\n\t\n\t\n\t_boot: function() {\n\t\tif( document.location.href.match(/\\?nocache/) ) {\n\t\t\tig.setNocache( true );\n\t\t}\n\t\t\n\t\t// Probe user agent string\n\t\tig.ua.pixelRatio = window.devicePixelRatio || 1;\n\t\tig.ua.viewport = {\n\t\t\twidth: window.innerWidth,\n\t\t\theight: window.innerHeight\n\t\t};\n\t\tig.ua.screen = {\n\t\t\twidth: window.screen.availWidth * ig.ua.pixelRatio,\n\t\t\theight: window.screen.availHeight * ig.ua.pixelRatio\n\t\t};\n\t\t\n\t\tig.ua.iPhone = /iPhone/i.test(navigator.userAgent);\n\t\tig.ua.iPhone4 = (ig.ua.iPhone && ig.ua.pixelRatio == 2);\n\t\tig.ua.iPad = /iPad/i.test(navigator.userAgent);\n\t\tig.ua.android = /android/i.test(navigator.userAgent);\n\t\tig.ua.winPhone = /Windows Phone/i.test(navigator.userAgent);\n\t\tig.ua.iOS = ig.ua.iPhone || ig.ua.iPad;\n\t\tig.ua.mobile = ig.ua.iOS || ig.ua.android || ig.ua.winPhone;\n\t\tig.ua.touchDevice = (('ontouchstart' in window) || (window.navigator.msMaxTouchPoints));\n\t},\n\t\n\t\n\t_initDOMReady: function() {\n\t\tif( ig.modules['dom.ready'] ) {\n\t\t\tig._execModules();\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tig._boot();\n\t\t\n\t\t\n\t\tig.modules['dom.ready'] = { requires: [], loaded: false, body: null };\n\t\tig._waitForOnload++;\n\t\tif ( document.readyState === 'complete' ) {\n\t\t\tig._DOMReady();\n\t\t}\n\t\telse {\n\t\t\tdocument.addEventListener( 'DOMContentLoaded', ig._DOMReady, false );\n\t\t\twindow.addEventListener( 'load', ig._DOMReady, false );\n\t\t}\n\t}\n};\n\n\n// -----------------------------------------------------------------------------\n// Provide ig.setAnimation and ig.clearAnimation as a compatible way to use\n// requestAnimationFrame if available or setInterval otherwise\n\n// Use requestAnimationFrame if available\nig.normalizeVendorAttribute( window, 'requestAnimationFrame' );\nif( window.requestAnimationFrame ) {\n\tvar next = 1,\n\t\tanims = {};\n\n\twindow.ig.setAnimation = function( callback, element ) {\n\t\tvar current = next++;\n\t\tanims[current] = true;\n\n\t\tvar animate = function() {\n\t\t\tif( !anims[current] ) { return; } // deleted?\n\t\t\twindow.requestAnimationFrame( animate, element );\n\t\t\tcallback();\n\t\t};\n\t\twindow.requestAnimationFrame( animate, element );\n\t\treturn current;\n\t};\n\n\twindow.ig.clearAnimation = function( id ) {\n\t\tdelete anims[id];\n\t};\n}\n\n// [set/clear]Interval fallback\nelse {\n\twindow.ig.setAnimation = function( callback, element ) {\n\t\treturn window.setInterval( callback, 1000/60 );\n\t};\n\twindow.ig.clearAnimation = function( id ) {\n\t\twindow.clearInterval( id );\n\t};\n}\n\n\n// -----------------------------------------------------------------------------\n// Class object based on John Resigs code; inspired by base2 and Prototype\n// http://ejohn.org/blog/simple-javascript-inheritance/\n\nvar initializing = false, fnTest = /xyz/.test(function(){xyz;}) ? /\\bparent\\b/ : /.*/;\n\nwindow.ig.Class = function(){};\nvar inject = function(prop) {\t\n\tvar proto = this.prototype;\n\tvar parent = {};\n\tfor( var name in prop ) {\t\t\n\t\tif( \n\t\t\ttypeof(prop[name]) == \"function\" &&\n\t\t\ttypeof(proto[name]) == \"function\" && \n\t\t\tfnTest.test(prop[name])\n\t\t) {\n\t\t\tparent[name] = proto[name]; // save original function\n\t\t\tproto[name] = (function(name, fn){\n\t\t\t\treturn function() {\n\t\t\t\t\tvar tmp = this.parent;\n\t\t\t\t\tthis.parent = parent[name];\n\t\t\t\t\tvar ret = fn.apply(this, arguments);\t\t\t \n\t\t\t\t\tthis.parent = tmp;\n\t\t\t\t\treturn ret;\n\t\t\t\t};\n\t\t\t})( name, prop[name] );\n\t\t}\n\t\telse {\n\t\t\tproto[name] = prop[name];\n\t\t}\n\t}\n};\n\nwindow.ig.Class.extend = function(prop) {\n\tvar parent = this.prototype;\n \n\tinitializing = true;\n\tvar prototype = new this();\n\tinitializing = false;\n \n\tfor( var name in prop ) {\n\t\tif( \n\t\t\ttypeof(prop[name]) == \"function\" &&\n\t\t\ttypeof(parent[name]) == \"function\" && \n\t\t\tfnTest.test(prop[name])\n\t\t) {\n\t\t\tprototype[name] = (function(name, fn){\n\t\t\t\treturn function() {\n\t\t\t\t\tvar tmp = this.parent;\n\t\t\t\t\tthis.parent = parent[name];\n\t\t\t\t\tvar ret = fn.apply(this, arguments);\t\t\t \n\t\t\t\t\tthis.parent = tmp;\n\t\t\t\t\treturn ret;\n\t\t\t\t};\n\t\t\t})( name, prop[name] );\n\t\t}\n\t\telse {\n\t\t\tprototype[name] = prop[name];\n\t\t}\n\t}\n \n\tfunction Class() {\n\t\tif( !initializing ) {\n\t\t\t\n\t\t\t// If this class has a staticInstantiate method, invoke it\n\t\t\t// and check if we got something back. If not, the normal\n\t\t\t// constructor (init) is called.\n\t\t\tif( this.staticInstantiate ) {\n\t\t\t\tvar obj = this.staticInstantiate.apply(this, arguments);\n\t\t\t\tif( obj ) {\n\t\t\t\t\treturn obj;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor( var p in this ) {\n\t\t\t\tif( typeof(this[p]) == 'object' ) {\n\t\t\t\t\tthis[p] = ig.copy(this[p]); // deep copy!\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( this.init ) {\n\t\t\t\tthis.init.apply(this, arguments);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\t\n\tClass.prototype = prototype;\n\tClass.prototype.constructor = Class;\n\tClass.extend = window.ig.Class.extend;\n\tClass.inject = inject;\n\t\n\treturn Class;\n};\n\n// Merge the ImpactMixin - if present - into the 'ig' namespace. This gives other\n// code the chance to modify 'ig' before it's doing any work.\nif( window.ImpactMixin ) {\n\tig.merge(ig, window.ImpactMixin);\n}\n\n})(window);\n\n\n\n// -----------------------------------------------------------------------------\n// The main() function creates the system, input, sound and game objects,\n// creates a preloader and starts the run loop\n\nig.module(\n\t'impact.impact'\n)\n.requires(\n\t'dom.ready',\n\t'impact.loader',\n\t'impact.system',\n\t'impact.input',\n\t'impact.sound'\n)\n.defines(function(){ \"use strict\";\n\nig.main = function( canvasId, gameClass, fps, width, height, scale, loaderClass ) {\n\tig.system = new ig.System( canvasId, fps, width, height, scale || 1 );\n\tig.input = new ig.Input();\n\tig.soundManager = new ig.SoundManager();\n\tig.music = new ig.Music();\n\tig.ready = true;\n\t\n\tvar loader = new (loaderClass || ig.Loader)( gameClass, ig.resources );\n\tloader.load();\n};\n\n});"]}